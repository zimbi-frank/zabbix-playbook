---
- name: check if line in file is there
  command: grep  DBPassword=zabbix /etc/zabbix/zabbix_server.conf
  register: checkmyconf
  always_run: True
  ignore_errors: True
  changed_when: False
  
- name: Insert lines for zabbix_server.conf file
  lineinfile: 
    dest: /etc/zabbix/zabbix_server.conf
    backup: yes

    regexp: "{{ item.outline }}"
    line: "{{ item.inline }}"
  with_items:
    - { outline: '^DBName=zabbix', inline: 'DBName=zabbix'}
    - { outline: '^DBUser=zabbix', inline: 'DBUser=zabbix'}
    - { outline: '^# DBPassword=', inline: 'DBPassword=zabbix'}
  when: checkmyconf.rc == 0

